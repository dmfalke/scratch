<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>SystemJS Scratch</title>
  </head>
  <body>
    <script src="https://unpkg.com/systemjs@0.19.41/dist/system.js"></script>
    <script>
      // typescript-plugin config
      SystemJS.config({
        packages: {
          "ts": {
            "main": "plugin.js",
          },
          "typescript": {
            "main": "lib/typescript.js",
            "meta": {
              "lib/typescript.js": {
                "exports": "ts"
              },
            }
          }
        },
        map: {
          ts: 'https://unpkg.com/plugin-typescript@5.3.1/lib/',
          typescript: 'https://unpkg.com/typescript'
        },
        transpiler: 'ts',
        typescriptOptions: {
          "noImplicitAny": true,
          "removeComments": false,
          "preserveConstEnums": true,
          "allowSyntheticDefaultImports": true,
          "noImplicitReturns": true,
          "sourceMap": true,
          "jsx": "react",
          "strictNullChecks": true,
          "lib": [ "dom", "es2015", "es2016" ]
        }
      })

      // app config
      SystemJS.config({
        paths: {
          'lodash/*': 'https://unpkg.com/lodash/*',
        },
      });

      System.register("test", [], function($__export) {
        console.log('executing test module')
        $__export({
          name: 'TEST',
          age: 123456
        });
      })

      System.import("test").then(test => console.log(test.name));

      Promise.all([
        System.import('lodash/partial'),
        System.import('./Task.ts')
      ])
      .then(([partial, {Task}]) => {
        new Task(partial(setTimeout, _, 1000, "Hello!")).run(console.log)
      })
    </script>
  </body>
</html>
